# catch-the-bus-server

## 목차

- [설치 방법](#설치-방법)
- [아쉬웠던 점](#아쉬웠던-점)
- [고민했던 점](#고민했던-점)
- [어려웠던 점](#어려웠던-점)
- [차후 개발 사항](#차후-개발-사항)
- [기술 스택](#기술-스택)

## 설치 방법

### Client

```
- npm install
- npx react-native run-android
```

### Server

```
- npm install
- npm start
```

## 아쉬웠던 점

### bare React Native를 제대로 활용하지 못했다.
- POC 때 expo와 bare React Native 중 어느 프레임워크로 프로젝트를 진행할지 많은 고민을 했었다.
  expo는 초보자가 다루기 쉽다는 장점이 있지만, expo에서 지원하지 않는 여러 라이브러리를 사용하고자 bare React Native를 사용하기로 결정했었다.
  하지만 처음 접해본 React Native를 다루며 device와 연동이 안되거나 서버 로컬 호스트를 잘못 찾는 등 여러 난관에 부딪히며 시간이 지연되어 라이브러리는 1개밖에 사용하지 못했다.
  물론 expo eject 기능으로 expo를 지원하는 라이브러리 외 React Native 라이브러리도 사용할 수 있다는 것을 알고 있었지만, 좀 더 코어 한 앱 개발에 가까운 환경을 경험해 보고 싶었다.
  expo와 bare React Native의 장단점을 찾아보며, expo를 하는 게 더 낫다, Flutter가 더 낫다는 등 React Native에 비관적인 평가를 많이 보았다.
  나는 오히려 React Native가 왜 가장 많은 추천을 받지 못하는지 그 이유를 알고 싶어서 React Native를 고집했었다.
  기회가 된다면 expo와 Flutter 그리고 더 나아가서 Native를 직접 경험해 보고 싶다.

### DB를 mongoDB가 아닌 mySQL로 진행해 보고 싶다.
- POC 때 Bus 데이터를 DB에 저장하는 게 아닌, API로 호출하려 했었다. 하지만 버스 노선과 정류장을 비교하기 위해서는 다량의 API가 필요했었다
  서울시 공공데이터에서 한 번 호출할 수 있는 API는 1000개였고, 나는 한 번에 10,000 개의 데이터를 호출해야 했었다. (앱 출시 후 한 번에 10,000건의 API 호출 가능)
  이 때문에 갑작스럽게 서버에서 데이터를 불러오는 방식으로 변경해야만 했다.
- 그러나 mongoDB에 데이터를 저장할 때 Schema 타입을 알맞게 택할 수 없었다.
  서울시 공공데이터를 JSON, CSV 파일로 다운로드해서 mongoDB Compass에서 직접 데이터를 삽입했는데, 문제는 Schema 타입을 직접 변경할 수 없었다.
  Schema 타입을 선택할 수 있는 목록이 있었지만, 좌표 같은 숫자 데이터 타입을 "Number"로 지정하더라도 저장된 데이터는 "Int32"였다.
  코드로 Schema 타입 변경을 시도했으나, 빈번히 실패한 뒤 시간에 쫓겨 "String"으로 저장했다.
  또한, Schema를 Bus와 Station으로 나눠서 populate 하지 못한 점이 아쉬웠다.
- mongoDB의 장점은 데이터를 형식에 얽매이지 않고 자유롭게 저장할 수 있다는 것인데, 형태가 엑셀 차트처럼 정해진 Bus 데이터에는 알맞지 않았다.
  mongoDB에 원하는 형태로 데이터를 저장하지 못한다고 판단했을 때 mySQL을 고려했으나,
  역시나 시간에 쫓겨서 익숙했던 mongoDB로 진행한 뒤 mySQL은 설치만 해보고 이용하지는 못했다.

### POC를 제대로 진행하지 않았다.
- 위 문제 모두 POC를 제대로 진행하지 않았기 때문에 발생한 일이다.
  React Native를 바로 사용할 수 있게 제대로 세팅했었더라면, 서울시 공공데이터 API를 최대 1000건만 호출할 수 있다는 것을 알았더라면 개발 시간이 더 늘어났을 것이다.
  개발 시간이 촉박해지자, 메인 기능 몇 개(OCR, 추천 검색어, 로그인과 즐겨찾기 목록)를 버리는 바람에 Mock up을 전면 수정하는 일이 생겼다.
  총 2번 레이아웃을 갈아엎어서 개발 시간은 더욱 줄어들었다.

## 고민했던 점

### 도착지에 가는 버스가 여러 대라면?
- 현재 구현한 로직은 단순히 버스 정류장 순서를 기준으로 도착지 순번에서 목적지 순번을 뺀 값을 사용하고 있다.
  구상했던 로직은 출발지 정류장 좌표 값과 도착지 정류장 좌표 값도 고려하여 최단거리를 갈 수 있는 방법을 구현하는 것이었다.
  하지만 mongoDB에 넣은 데이터를 불러오고 대조하는 과정에 시간을 많이 할애하는 바람에 구상했던 부분을 다 살리지 못했다.
  이는 데이터를 제대로 가공하지 않은 채 DB에 넣었고, 하물며 알맞은 DB를 택하지 않았기 때문에 생긴 문제라 판단한다.
  기존에 존재하는 버스 앱에 못 미치는 미약한 로직 때문에 조회된 모든 버스의 정류장 수를 표시하여 약간이나마 보완하려 했다.

### 도착지 추천 검색어(미구현)
- 더 편리하게 앱을 사용할 수 있도록 도착지 추천 검색어를 구현하고 싶었다.
  사용자가 출발지, 탑승할 버스 번호(사용자 바로 앞에 있는)를 입력하면 서울시 공공데이터 통계를 활용하여 지난달 동시간 대 가장 많이 하차한 정류장을 추천하는 기능이다.
  이는 단순히 사용자가 입력한 탑승할 버스 번호뿐만 아니라, 출발지를 입력하면 그 출발지를 지나치는 모든 버스를 조회하여 동시간 대 가장 많이 하차한 정류장을 찾는 기능이다.
  사용자(특히 고령)가 직접 목적지를 타이핑할 때 느끼는 피로를 덜고 싶었다.

## 어려웠던 점

### React인 듯 React와 다른 React Native
- React와 React Native의 문법은 미묘하게 다르다.
  HTML 태그를 사용하는 React와 달리 React Native는 고유의 태그가 있고 속성도 약간 다르다.
  만약 React를 모르는 채로 React Native를 진행했더라면, 하나부터 열까지 찾아보며 코드를 작성했을 것이다.
  하지만 React를 먼저 배운 뒤 React Native를 진행하며 의심 없이 써 내려간 내 코드에는 분명 React Native스럽지 못한 부분이 있을 것이다.
  에러가 발생하거나 애매하거나 의심스러운 부분은 가능하면 다 찾아봤지만, 100% 찾아내지 못한 부분이 마음에 걸린다.
  
- React Native는 터치를 기반으로 한다.
  처음 Mock up은 웹을 생각하며 만들었었다.
  그러나 웹을 기준으로 만든 레이아웃은 모바일 사용자를 기준으로 생각해 보면 몹시 불편하다.
  마우스를 클릭할 때 보다 손가락으로 터치를 할 때 피로가 더 느껴진다. 모바일은 좀 더 간단한 UX를 원한다.
  얇은 마우스 포인터로 커다란 모니터에 세밀한 작업을 할 수 있지만, 보다 굵은 손가락으로 더 작은 화면을 조작할 때에는 피로가 더해진다.
  이를 염두에 두지 못한 채 Mock up을 진행하는 바람에 만들어 놓은 레이아웃을 삭제하는 수고가 늘었었다.
  최종적으로 버튼 크기를 키우고 불필요한 모달 삭제했으며 레이아웃을 단순화하여 좀 더 모바일에 적합한 UX를 만들려고 노력했다.
  
- 웹에는 크롬, 사파리가 있지만 모바일에는 iOS와 안드로이드가 있다.
  React Native 공식 문서를 읽어보며 어떤 옵션에는 iOS 마크만 달려있고, 어떤 옵션에는 안드로이드 마크만 달려있는 모습을 심심치 않게 볼 수 있었다.
  다른 개발자들의 코드를 참고하면, iOS 일 때와 안드로이드일 때 보여주는 값을 달리하는 코드를 볼 수 있었다.
  나는 이 옵션을 잘 활용하지 못해서 아쉬웠다. 좀 더 세밀하게 React Native를 공부했더라면 훨씬 자연스럽고 보기 편한 앱을 구성했을 것이다.

## 차후 개발 사항
- mySQL로 데이터를 저장한 뒤 mongoDB와 차이점을 경험해 보고 싶다.
- 시간상 구현하지 못했던 OCR, 추천 검색어, 로그인과 즐겨찾기 목록을 진행해 보고 싶다.
- 현재 정류장 이름이 정확하게 일치하는 노선의 결과만 알려주고 있는데, 그 범위를 근처 정류장까지 확대하고 싶다.
- 직행버스가 없을 때 갈아타는 노선을 알려주고 싶다.

## 기술 스택

### FrontEnd

- React Native
- React Navigation

### BackEnd

- Node.js
- Express
- MongoDB
- Mongoose
